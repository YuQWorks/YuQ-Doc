(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{391:function(s,t,a){"use strict";a.r(t);var e=a(45),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"关于信息本身"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于信息本身"}},[s._v("#")]),s._v(" 关于信息本身")]),s._v(" "),a("p",[s._v("在YuQ的系统中，我们对于每条信息都只需要考虑信息本身，不用考虑信息的来源又或者信息的发送方，信息本身只有信息。")]),s._v(" "),a("h2",{attrs:{id:"message"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#message"}},[s._v("#")]),s._v(" Message")]),s._v(" "),a("p",[s._v("在YuQ中，我们发送和接受的都是"),a("code",[s._v("Message")]),s._v("类型，也就是信息本身，而QQ的信息可以被称为是富文本的，因为除了文字以外，还包括图片，表情，语音，甚至分享卡片等。")]),s._v(" "),a("p",[s._v("所以YuQ设计了"),a("code",[s._v("MessageItem")]),s._v("来解决这个问题，不同的元素会变成不同的"),a("code",[s._v("MessageItem")]),s._v("，方便了我们对于信息内容的拼接和分割。")]),s._v(" "),a("h3",{attrs:{id:"messageitem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#messageitem"}},[s._v("#")]),s._v(" MessageItem")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("MessaegItem")]),s._v("中，信息被分为了"),a("code",[s._v("text")]),s._v("，"),a("code",[s._v("image")]),s._v("，"),a("code",[s._v("voice")]),s._v("，"),a("code",[s._v("face")]),s._v("，"),a("code",[s._v("at")]),s._v("，"),a("code",[s._v("JsonEx")]),s._v("，"),a("code",[s._v("XmlEx")]),s._v("，"),a("code",[s._v("NoImpl")]),s._v("等内容。")]),s._v(" "),a("p",[s._v("其中"),a("code",[s._v("text")]),s._v("，"),a("code",[s._v("image")]),s._v("，"),a("code",[s._v("voice")]),s._v("，"),a("code",[s._v("face")]),s._v("，"),a("code",[s._v("at")]),s._v("五个可以说是基本内容。")]),s._v(" "),a("p",[a("code",[s._v("text")]),s._v("是基本的文字内容，也是最常触发命令的方式。")]),s._v(" "),a("p",[a("code",[s._v("image")]),s._v("是群内发送的图片，也包括表情包图片。")]),s._v(" "),a("p",[a("code",[s._v("voice")]),s._v("是指声音，可以指定文件让你的机器人发送音频文件。")]),s._v(" "),a("p",[a("code",[s._v("face")]),s._v("是指腾讯自带的表情。")]),s._v(" "),a("p",[a("code",[s._v("at")]),s._v("是指群聊中的@某人。")]),s._v(" "),a("p",[s._v("而"),a("code",[s._v("JsonEx")]),s._v("，"),a("code",[s._v("XmlEx")]),s._v("和"),a("code",[s._v("NoImpl")]),s._v("则相对比较特殊。")]),s._v(" "),a("p",[a("code",[s._v("JsonEx")]),s._v("和"),a("code",[s._v("XmlEx")]),s._v("分别表示的是Json卡片和Xml卡片，曾经的假红包就属于这两种，音乐分享卡片也属于这个。")]),s._v(" "),a("p",[a("code",[s._v("NoImpl")]),s._v("则表示不支持的内容，比如红包。")]),s._v(" "),a("h2",{attrs:{id:"messageitemfactory"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#messageitemfactory"}},[s._v("#")]),s._v(" MessageItemFactory")]),s._v(" "),a("p",[s._v("已经知道了"),a("code",[s._v("MessageItem")]),s._v("之后，如何才能创建一个"),a("code",[s._v("MessageItem")]),s._v("呢？")]),s._v(" "),a("p",[s._v("通常来说，你可以使用"),a("code",[s._v("@Inject")]),s._v("来注入一个YuQ自带的"),a("code",[s._v("MessageItemFactory")]),s._v("。就像下面代码这样：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Inject")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MessageItemFactory")]),s._v(" mif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("那么应该如何使用"),a("code",[s._v("MessageItemFactory")]),s._v("来创建一个信息呢？")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("    mif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"想输出一段文本"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    mif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"想输出一段文本"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("plus")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("imageByFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("只要翻一翻"),a("code",[s._v("mif")]),s._v("所提供的方法，就能找到创建对应内容的方法，非常简便和快捷。")]),s._v(" "),a("p",[s._v("但是在上面的代码中，我们需要注意两个东西：")]),s._v(" "),a("ul",[a("li",[s._v("plus() ： plus方法提供三个重载的方法，分别允许"),a("code",[s._v("String")]),s._v("，"),a("code",[s._v("MessageItem")]),s._v("和"),a("code",[s._v("Message")]),s._v("，这使得你的信息可以自由拼接，使用"),a("code",[s._v(".plus()")]),s._v("之后信息会被合成一条。在上面第二行中，就是文字+图片一起发送。")]),s._v(" "),a("li",[s._v("toMessage()： 这个方法是将"),a("code",[s._v("MessageItem")]),s._v("转为"),a("code",[s._v("Message")]),s._v("，毕竟YuQ的接受和发送都是使用的"),a("code",[s._v("Message")]),s._v("对象。")])]),s._v(" "),a("h3",{attrs:{id:"lineq"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lineq"}},[s._v("#")]),s._v(" LineQ")]),s._v(" "),a("p",[s._v("我还没有咋用过，所以先不详解。放一段示例代码：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testLineQ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Message")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("linQ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" qq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("linQ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("at")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("qq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("textLine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('",您好。"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("textLine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"您是第xxx位加入本群的"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("相比较"),a("code",[s._v("MessageItemFactory")]),s._v("而言，他看起来更加简洁，容易书写，可以尝试一下。")]),s._v(" "),a("h2",{attrs:{id:"最后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最后"}},[s._v("#")]),s._v(" 最后")]),s._v(" "),a("p",[s._v("想不到太多关于"),a("code",[s._v("Message")]),s._v("需要讲述的内容，所以重点放在了信息的拼接上，如果有什么问题欢迎群内@我，或者在"),a("a",{attrs:{href:"https://github.com/YuQWorks/YuQ-Doc",target:"_blank",rel:"noopener noreferrer"}},[s._v("项目地址"),a("OutboundLink")],1),s._v("下提出issue。")])])}),[],!1,null,null,null);t.default=n.exports}}]);